## 量子比特测量

版权所有 (c) 2021 百度量子计算研究所，保留所有权利。

### 背景

在本章第二节中，介绍了用于评判量子计算机能否实现的 “DiVincenzo 标准”。完整的量子计算机需要具备量子态测量的能力，量子测量是将量子信息转换为经典信息的关键。具体而言，在超导电路中实现量子测量的方法是通过谐振器对微波脉冲信号的不同响应来判断被测系统所处的量子态。

为了实现容错量子计算，由测量引起的误差应该低于纠错码的阈值，一般要求测量的保真度高于 99% [1]。然而在读取的过程中，由于量子比特需要和谐振器耦合，并且需要引入读取脉冲，导致量子比特和外界的相互作用增强，使得量子比特的退相干（Decoherence）和失相（Dephasing）变得更加严重，从而导致量子信息丢失，保真度降低。因此，为了实现高保真度测量，需要在保证量子比特和环境有一定的相互作用（以便我们读取量子信息）的同时，保证测量对量子比特的退相干和失相造成的影响较小，从而实现多次、快速的量子比特读取。

本章节主要介绍量子测量的物理原理，以及如何设计脉冲使得读取效果更好。结合量脉平台提供的单量子比特模拟器，演示量子读取过程。除此之外，还会简单介绍读取噪声来源和抑制的方法。

### 量子比特读取原理

#### 量子比特读取过程

为了获得量子比特的状态信息，通常需要对被测系统施加一个“探针”，也就是脉冲。但是，不能让脉冲直接与量子比特产生相互作用，这是由于直接操控会破坏量子态，导致读取错误。如图 1 所示，为了测量量子比特的状态，将生成的脉冲信号输入到与量子比特耦合的谐振器（谐振器与量子比特的耦合强度为 g）中，并且对输出的信号进行放大和处理，通过读取输出信号的信息来判断被测系统的量子状态 [2]。



![量子测量](https://qulearn.baidu.com/static/973df280eb2435f700c7786958a4881d/fcda8/meas-fig-readout_setup.png)

图 1：量子读取的装置



#### 探测信号及处理

在超导量子比特的读取过程中，通常不直接探测量子比特本身，而是生成一个输入信号 sin 来激发与量子比特耦合的谐振器，并且接收输出的信号 sout。输入信号和输出信号分别表示为：

sin(t)=Re[Ainei(ωrot)]=Aincos(ωrot),(1)sout(t)=Re[Aouteiθoutei(ωrot)]=Aoutcos(ωrot+θout).(2)

其中，Ain 和 Aout 分别是输入信号 sin 和输出信号 sout 的振幅，ωro 是输入信号与输出信号的频率，θout 则是输出信号的相位。

输入信号 sin(t) 与被测系统相互作用后，振幅和相位都会发生变化，且改变的大小取决于被读取的量子态，因此可以通过读取输出信号来获取被测系统的量子态信息。为了得到含有量子态信息的输出脉冲相位 θout，利用外差解调 [2]（Heterodyne Demodulation）方法处理 sout(t)。信号经过处理后，与时间相关、频率为 ωro 的分量被消去，得到两个正交的分量 I 和 Q。

I=Scosθout∝Aoutcosθout,(3)Q=Ssinθout∝Aoutsinθout，(4)

其中 S 是振幅。定义 z 是读取结果的复数表示形式，I 和 Q 分别为 z 的实数部分和虚数部分：

z=I+iQ=Scosθout+iSsinθout=Seiθout.(5)

注意到 z 是一个复数，因此可以用一个复平面上的点来表示 z。 在 I-Q 复平面上，z 对应的坐标是 (I,Q)，|S| 是点的模长，θout 对应相位。实际读取结果如图 2 所示，每一个点都对应一次读取结果，其模长与振幅 Aout 相关，相位差 Δθ 是读取结果 z|0⟩ 和 z|1⟩ 的两个相位 θ|0⟩ 和 θ|1⟩ 的差值：

Δθ=|θ|0⟩−θ|1⟩|.(6)

当相位差 Δθ 最大时，I-Q 平面上不同量子态的读取结果的点之间分离程度最大，代表读取误差最小。



![量子态读取结果](https://qulearn.baidu.com/static/79fde964a112dfb0e261c550de84c440/fcda8/meas-fig-state_discrimination.png)

图 2：量子态读取结果在 I-Q 复平面上的呈现



#### 色散读取

根据上文的讨论，输出信号的振幅和相位与量子比特的量子态有关。为了获得较好的读取效果，I-Q 复平面上的数据点需要有好的可区分度，要实现上述效果通常需要选取合理的输入信号参数。为了进一步论述，先介绍量子读取背后的物理原理。

首先，量子比特与谐振器耦合作用可以用 Jaynes-Cummings 哈密顿量来描述 [3]:

HJCℏ=ωr(^a†^a+12)+ωq2^σz+g(^σ+^a+^σ−^a†),(7)

公式 (7) 的 Jaynes-Cummings 哈密顿量描述的是谐振器和量子比特之间的耦合作用，其中 ωr 和 ωq 分别表示谐振器和量子比特的频率，^a† 和 ^a 分别是谐振器量子态的上升算符和下降算符，^σz、^σ+、^σ− 分别是量子比特量子态的泡利 Z 算符、上升算符和下降算符，g 是谐振器和量子比特之间的耦合强度。

当谐振器和量子比特间的失谐足够大，即 g≪|ωq−ωr| 时，利用 Schrieffer-Wolff 变换对 HJC 进行近似处理（色散近似），得到 Hdisp：

Hdispℏ=(ωr+χ^σz)(^a†^a+12)+ωq+χ2^σz，(8)

其中， χ=g2/|ωq−ωr|。 当失谐 |ωq−ωr| 远大于耦合强度 g 和谐振器的谱线宽度（Resonator Linewidth）κ 时，量子比特和谐振器之间无直接的能量交换，谐振器和量子比特的本征频率会产生一个小的频移 χ，称之为色散频移（Dispersive Shift）。因为 g≪|ωq−ωr| ，所以这个频移 χ 非常微小，不会对量子比特的状态产生大的影响，从而保证非破坏性测量。从公式 (8) 的第一项可以看出，因为 ^σz 项的存在，谐振器的频率将取决于被测系统所处的量子态，且频率 ω|0⟩ 与 ω|1⟩ 之间相差 2χ，其中 χ 是色散频移的值。因此，当被探测的量子态坍缩到 |0⟩ 或者 |1⟩ 的时候，谐振器的本征频率也会发生不同的改变。如图 3 所示，当探测信号的频率为 ωro=(ω|0⟩+ω|1⟩)/2，输出信号的相位差 Δθ=|θ|0⟩−θ|1⟩| 最大，这时候 I-Q 复平面上读取的不同量子态数据点之间的距离最大，读取的分辨效果最好。



![色散频移](https://qulearn.baidu.com/static/9f9214e37c0a6cb3a85e56d8314df26e/fcda8/meas-fig-dispersive_shift.png)

图 3：读取信号的振幅和相位与输入信号频率的关系



### 量子测量的噪声和抑制方法

目前量子计算处在“有噪中等规模量子”（Noisey Intermediate-Scale Quantum，NISQ）阶段，噪声极大地限制了量子算法的在当前硬件上的应用。下面分析量子测量噪声的来源，并且介绍减少噪声的技术手段。

量子测量的噪声主要有两个来源，其一是谐振器本身的热涨落效应和测量过程中产生的噪声，会影响不同态的可区分度；其二是由于量子比特从激发态 |1⟩ 衰退至基态 |0⟩，导致读取结果不正确。本章节将论述这两类噪声是如何影响读取的精确度和准确性的，以及如何进行抑制。

#### 噪声

如图 4 所示，由于噪声的存在，多次测量同一个物理系统的量子态，读取结果在 I-Q 平面上会形成二维高斯分布。将 I-Q 平面上的点投影到 I 轴或者 Q 轴上，得到一维高斯分布。两个量子态 |0⟩ 和 |1⟩ 高斯分布的均值 μ 是读取点分布最集中的值；而高斯分布的曲线半高宽度 2σ 体现了分布的离散程度。

中心点距离 Δμ 与读取时间和色散频移相关，读取点分布的离散程度 σ 与噪声相关。如果量子态读取结果之间距离 Δμ=|μ|1⟩−μ|0⟩| 较小，或者分布的标准差 σ|0⟩ 和 σ|1⟩ 较大（通常可以认为 σ|0⟩ 等于 σ|1⟩），都会使得分布曲线重叠面积变大，增加我们区分不同量子态的难度。比如图 4 中的右图，比左图的读取点分布重叠面积更大，读取的保真度就会更低。



![高斯噪声分布](https://qulearn.baidu.com/static/a467761b146be7317588386111f1ea8b/fcda8/meas-fig-guassian_distribution.png)

图 4：量子比特读取的高斯噪声分布



信噪比 SNR（Signal-to-Noise Ratio）是一种量化噪声对信号读取影响的手段，其定义是均值差 Δμ 与两倍半高宽 2σ 的比值。

SNR=Δμ4σ=|μ|1⟩−μ|0⟩|4σ,(9)

信噪比越大，两个分布曲线之间的重叠面积越小，读取的保真度越高。

在实际量子测量中，输入脉冲信号本身的噪声和放大器增加的噪声都会影响最后的读取效果。输出信号往往是非常弱的，一般只有不到 10−16 W，因此在数据处理之前输出信号需要通过放大器增强。然而放大器反过来又会引入相当多的噪声至输出信号，最终导致极低的信噪比。利用一个特殊的放大器，使得增加的噪声尽可能低，保持信噪比在可接受范围里。这种特殊的放大器被称为“ QLA 放大器”（Quantum-Limited Amplifier，QLA）[2]。

如果使用线性的、对相位变化不敏感的放大器，原信号经过这种放大器放大后，相位不会改变，而且信号的两个正交的成分 I 和 Q 都同等放大。根据 Caves 定理 [4]，增益必然会带来额外的噪声，如不等式 (10) 所示：

|ΔF|2≥12|G−1|,(10)

其中， |ΔF|2 表示因放大器额外增加的噪声，G 表示增益， √G 就是信号放大的倍数。

放大器放大后的信号的噪声 |Δb|2 有两个来源，一部分是经放大器放大的噪声 G|Δa|2（ |Δa|2 是原信号的噪声)，另一部分是放大器本身额外增加的噪声 |ΔF|2 ：

|Δb|2=G|Δa|2+|ΔF|2.(11)

由于零点涨落（Zero-Point Fluctuations)的存在，原信号存在理论最小的噪声 |Δa|2≥1/2。再结合 Caves 定理，得出噪声 |Δb|2 关于增益 G（G≥1）的不等式：

|Δb|2≥12G+12|G−1|=G−12,(12)

此不等式表明了信号放大后的理论最小噪声。如果原信号噪声大于理论最小噪声，且 G≫1，则有：

|Δb|2≥G|Δa|2+12|G−1|=G(|Δa|2+12),(13)|Δb|min=√G(|Δa|2+1/2),(14)

其中， |Δb|min 就是经过 QLA 放大器 [5] 放大后的信号的最小噪声。如图 5，在测量电路中，输出信号先经过 QLA 放大器，然后再经过低噪声放大器（Low Noise Amplifier，LNA）放大信号。其信噪比主要由 QLA 放大器所决定，而后续的低噪声放大器对信噪比的影响非常有限。



![qla 图片](https://qulearn.baidu.com/static/33687c8734e3068bf1b688b3654afbb7/fcda8/meas-fig-QLA.png)

图 5：测量电路中的 QLA 放大器和低噪声放大器



#### 噪声的抑制方法

在量子测量中，一方面希望谐振器与环境的耦合强度 kr 能足够大，使得光子进出谐振器的速度够快，保证读取的时间能远低于量子比特的相干时间，实现更多次的读取；另一方面又希望耦合强度 kr 不要太大，避免从量子比特到谐振器的能量泄露过大。

量子比特与谐振器耦合，谐振器与环境的相互作用会增强量子比特的自发辐射（Spontaneous Emission），导致从激发态 |e⟩ 衰退至基态 |g⟩。如果一个系统初始态处于激发态 |e⟩，经过时间 t，此系统仍处在激发态的概率是：

P(t)=e−t/T1,(15)

其中， T1 为弛豫时间 (relaxation time)，倒数 γ=1/T1 描述了衰减的速率。所以在设计超导电路的测量电路时，应该考虑如何增加量子比特的弛豫时间，同时要保证一定的耦合强度 kr。如果量子比特-谐振器系统直接与环境接触，乘积 krT1 存在一个上限 [6]：

krT1≤(Δg)2.(16)

由不等式 (16) 可知，如果量子比特-谐振器耦合强度 g 以及失谐 Δ=|ωq−ωr| 不变，不可能同时增加弛豫时间 T1 和谐振器-环境耦合强度 kr。若增加失谐 Δ，则会导致色散频移 χ=g2/Δ 减小，读取信号区分度降低，测量保真度也会随之减小。为了减少谐振器对量子比特弛豫时间的影响，通常会在谐振器和环境之间引入 Purcell 滤波器[2]，设置谐振器频率在滤波器的带通中，而量子比特频率在带通之外。滤波器的作用是屏蔽频率在带通外的量子比特，尽量使其不受环境干扰，同时加强谐振器-环境的耦合强度 kr。此时乘积 krT1 满足不等式：

krT1≤(Δg)2(ωrωq)(2QFΔωr)2=(Δg)2(ωrωq)α,(17)

在上述不等式 (17) 中，QF 是 Purcell 滤波器的品质因子，定义为滤波器的中心频率与带宽的比值。乘积项 α=4Q2FΔ2/ω2r 一般可以提高 krT1 的上限将近 100 倍。由此，通过加入一个滤波器，我们就可以保持失谐 Δ 以及弛豫时间 T1 不变的同时，增加 kr 来实现更快速的测量。

### 总结

本节主要从物理角度介绍了量子测量的过程和原理。从输入脉冲和输出脉冲出发，讨论了实验中常用的 I-Q 复平面。然后从系统哈密顿量角度，分析了量子态读取的物理机制。最后，讨论了量子测量误差主要来源，引入信噪比的概念来量化读取效果，并且指出业界常用提高量子读取效果的方法。

### 参考资料

[1] Krantz, Philip, et al. "Single-shot read-out of a superconducting qubit using a Josephson parametric oscillator." [Nature Communications](https://www.nature.com/articles/ncomms11417) 7.1 (2016): 1-8.

[2] Krantz, Philip, et al. "A quantum engineer's guide to superconducting qubits." [Applied Physics Reviews](https://aip.scitation.org/doi/abs/10.1063/1.5089550) 6.2 (2019): 021318.

[3] Blais, Alexandre, et al. "Cavity quantum electrodynamics for superconducting electrical circuits: An architecture for quantum computation." [Physical Review A](https://journals.aps.org/pra/abstract/10.1103/PhysRevA.69.062320) 69.6 (2004): 062320.

[4] Caves, Carlton M. "Quantum limits on noise in linear amplifiers." [Physical Review D](https://journals.aps.org/prd/abstract/10.1103/PhysRevD.26.1817) 26.8 (1982): 1817.

[5] Roy, Ananda, and Michel Devoret. "Introduction to parametric amplification of quantum signals with Josephson circuits." [Comptes Rendus Physique](https://www.sciencedirect.com/science/article/pii/S1631070516300640) 17.7 (2016): 740-755.

[6] Jeffrey, Evan, et al. "Fast accurate state measurement with superconducting qubits." [Physical Review Letters](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.112.190504) 112.19 (2014): 190504.

*最后更新时间：2021年12月20日*